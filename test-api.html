<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .box { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #17a2b8; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; background: #17a2b8; color: white; border: none; border-radius: 3px; }
        button:hover { background: #138496; }
        pre { background: #f0f0f0; padding: 10px; border-radius: 3px; overflow-x: auto; }
        .error { border-left-color: #dc3545; color: #dc3545; }
        .success { border-left-color: #28a745; color: #28a745; }
    </style>
</head>
<body>
    <h1>ðŸ§ª BAZAR HmI API Test</h1>
    
    <div class="box">
        <h3>1. Test Root Endpoint</h3>
        <button onclick="testRoot()">GET /</button>
        <pre id="root-result">No response yet</pre>
    </div>

    <div class="box">
        <h3>2. Test Login</h3>
        <button onclick="testLogin()">POST /api/login (password: admin123)</button>
        <pre id="login-result">No response yet</pre>
    </div>

    <div class="box">
        <h3>3. Test Get Menus</h3>
        <button onclick="testMenus()">GET /api/menus</button>
        <pre id="menus-result">No response yet</pre>
    </div>

    <div class="box">
        <h3>4. Test Post Order</h3>
        <button onclick="testOrder()">POST /api/orders</button>
        <pre id="order-result">No response yet</pre>
    </div>

    <script>
        const API_URL = 'http://localhost:3000';

        async function testRoot() {
            try {
                const res = await fetch(`${API_URL}/`);
                const data = await res.json();
                document.getElementById('root-result').textContent = JSON.stringify(data, null, 2);
                document.getElementById('root-result').parentElement.classList.add('success');
            } catch (e) {
                document.getElementById('root-result').textContent = 'Error: ' + e.message;
                document.getElementById('root-result').parentElement.classList.add('error');
            }
        }

        async function testLogin() {
            try {
                const res = await fetch(`${API_URL}/api/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ password: 'admin123' })
                });
                const data = await res.json();
                document.getElementById('login-result').textContent = `Status: ${res.status}\n${JSON.stringify(data, null, 2)}`;
                document.getElementById('login-result').parentElement.classList.add(res.ok ? 'success' : 'error');
            } catch (e) {
                document.getElementById('login-result').textContent = 'Error: ' + e.message;
                document.getElementById('login-result').parentElement.classList.add('error');
            }
        }

        async function testMenus() {
            try {
                const res = await fetch(`${API_URL}/api/menus`);
                const data = await res.json();
                document.getElementById('menus-result').textContent = JSON.stringify(data, null, 2);
                document.getElementById('menus-result').parentElement.classList.add('success');
            } catch (e) {
                document.getElementById('menus-result').textContent = 'Error: ' + e.message;
                document.getElementById('menus-result').parentElement.classList.add('error');
            }
        }

        async function testOrder() {
            try {
                const res = await fetch(`${API_URL}/api/orders`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        customerName: 'Test User',
                        items: [{ name: 'Makan', quantity: 1, price: 10000 }],
                        totalPrice: 10000
                    })
                });
                const data = await res.json();
                document.getElementById('order-result').textContent = `Status: ${res.status}\n${JSON.stringify(data, null, 2)}`;
                document.getElementById('order-result').parentElement.classList.add(res.ok ? 'success' : 'error');
            } catch (e) {
                document.getElementById('order-result').textContent = 'Error: ' + e.message;
                document.getElementById('order-result').parentElement.classList.add('error');
            }
        }

        // Auto-test on load
        window.addEventListener('load', () => {
            testRoot();
        });
    </script>
</body>
</html>
